version: '3.8'

services:
  dashboard:
    build: .
    container_name: dashboard-app
    restart: unless-stopped
    ports:
      - "${BACKEND_PORT:-3001}:${BACKEND_PORT:-3001}"
    env_file:
      - path: ./docker.env
        required: false
    environment:
      # App mode
      - NODE_ENV=production
      # MongoDB Configuration (MONGO_HOST must be set - cannot use 127.0.0.1 with bridge networking)
      - MONGO_HOST=${MONGO_HOST:?MONGO_HOST is required}
      - MONGO_PORT=${MONGO_PORT:-27017}
      - MONGO_USERNAME=${MONGO_USERNAME:-dashboard_user}
      - MONGO_PASSWORD=${MONGO_PASSWORD:-changeme}
      - MONGO_DATABASE=${MONGO_DATABASE:-dashboard}
      # Backend Configuration
      - BACKEND_PORT=${BACKEND_PORT:-3001}
      - JWT_SECRET=${JWT_SECRET:-auto-generated-if-not-set}
